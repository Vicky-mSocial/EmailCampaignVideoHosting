<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mSocial - Campaign</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
        }
        .container {
            position: absolute;
            width: 100%;
            max-width: 1000px;
            aspect-ratio: 16 / 9;
        }
        .video-wrapper {
            position: absolute;
            top: 40%;
            left: 50%;
            width: 80%;
            transform: translate(-50%, -50%);
        }
        .button-wrapper {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
        }
        .button-wrapper button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        .message {
            display: none;
            background-color: yellow;
            padding: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            border: 2px solid #000;
        }
        @media (max-width: 600px) {
            .video-wrapper {
                width: 95%; /* Width for mobile screens */
            }
            .button-wrapper {
                bottom: -80px;
            }
            .button-wrapper button {
                width: 100%;
                padding: 15px;
                font-size: 18px;
            }
        }
    </style>
    <script>
        function getEmailFromURL() {
            const params = new URLSearchParams(window.location.search);
            return params.get('wemail');
        }

        
        function RecordVisitorLandedOnPage() {
            const email = getEmailFromURL();
            if (!email) {
                alert('Email parameter is missing in the URL.');
                return;
            }

            const url = `https://462dg3vi3e42y7tudtwmtdh5nu0rnpus.lambda-url.ap-south-1.on.aws/?wemail=${email}&categ=8494`;

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text(); // Expecting plain text response
                })
                .then(data => {
                    if (data === 'success') {
                       console.log("Visitor recorded");
                    } else {
                        throw new Error('Unexpected response data');
                    }
                })
                .catch(error => {
                    console.log('An error occurred. Please try again later.');
                });
        }

        function redeemOffer() {
            const email = getEmailFromURL();
            if (!email) {
                alert('Email parameter is missing in the URL.');
                return;
            }

            const button = document.querySelector('.button-wrapper button');
            const message = document.querySelector('.message');

            button.disabled = true;

            const url = `https://462dg3vi3e42y7tudtwmtdh5nu0rnpus.lambda-url.ap-south-1.on.aws/?wemail=${email}&categ=8497`;

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text(); // Expecting plain text response
                })
                .then(data => {
                    if (data === 'success') {
                        message.style.display = 'block';
                    } else {
                        throw new Error('Unexpected response data');
                    }
                    button.style.display = "none";
                })
                .catch(error => {
                    alert('An error occurred. Please try again later.');
                    button.style.display = "none";
                });
        }
        RecordVisitorLandedOnPage();
    </script>
</head>
<body>
    <div class="container">
        <div class="video-wrapper">
            <script src="https://fast.wistia.com/embed/medias/y1291k9rb2.jsonp" async></script>
            <script src="https://fast.wistia.com/assets/external/E-v1.js" async></script>
            <div class="wistia_responsive_padding" style="padding:56.25% 0 0 0;position:relative;">
                <div class="wistia_responsive_wrapper" style="height:100%;left:0;position:absolute;top:0;width:100%;">
                    <div class="wistia_embed wistia_async_y1291k9rb2 seo=true videoFoam=true" style="height:100%;position:relative;width:100%">
                        <div class="wistia_swatch" style="height:100%;left:0;opacity:0;overflow:hidden;position:absolute;top:0;transition:opacity 200ms;width:100%;">
                            <img src="https://fast.wistia.com/embed/medias/y1291k9rb2/swatch" style="filter:blur(5px);height:100%;object-fit:contain;width:100%;" alt="" aria-hidden="true" onload="this.parentNode.style.opacity=1;" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="button-wrapper">
            <button onclick="redeemOffer()">Redeem Offer</button>
            <div class="message">
                Offer sent to your mail. Have a great day!
            </div>
        </div>
        
    </div>
</body>
</html>
