<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://msocialverse.com/wp-content/uploads/2024/03/cropped-FavIcon-32x32.png" sizes="32x32">
    <link rel="icon" href="https://msocialverse.com/wp-content/uploads/2024/03/cropped-FavIcon-192x192.png" sizes="192x192">
    <title>mSocial Marketing Agency</title>
    <style>
        body, html {
            margin: 0;
            border:none;
            background-color: #f0f0f0;
        }
        .container {
            position: relative;
            min-width: 50%;
            width:800px;
            max-width:95%;
            height:100%;
            /* background:red; */
            left:50%;
            transform: translateX(-50%);
        }
        .section {
            position: relative;
            width:100%;
            height:auto;
            padding:5px;
            /* background-color: yellow;
            border:1px solid black; */
            box-sizing: border-box;
        }
        .questions {
            left: 50%;
            width: 90%;
            transform: translateX(-50%);
            background:white;
            border-radius: 7px;
            border:1px solid #ddd;
            padding:20px;
        }
        .logo
        {
            position: relative;
            padding-top:20px;
            left: 50%;
            width:30%;
            max-width: 400px;
            min-width:200px;
            transform: translateX(-50%);
            /* background:green; */
        }
        .logo img
        {
            width:100%;
            height:auto;
        }
        .tag-line
        {
            width:100%;
            height:auto;
            color:black;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: clamp(3vh, 4vw, 3.2vh);
            font-weight:bold;
            text-align: center;
            padding:20px;
            padding-top:50px;;
        }
        .hint-line
        {
            width:100%;
            height:auto;
            left: 50%;
            color:black;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: clamp(2vh, 3vw, 2.5vh);
            font-weight:400;
            text-align: center;
            transform: translateX(-50%);
            padding-bottom:60px;
            display: none;
        }
        .button-wrapper
        {
            padding-top:20px;
        }
        .button-wrapper button {
            position: relative;
            padding: 15px 30px;
            font-size: 16px;
            cursor: pointer;
            border:none;
            color:white;
            font-size: clamp(2.5vh, 3.5vw, 2.8vh);
            font-weight:bold;
            border-radius: 4px;
            background-color: rgba(255, 51, 0, 0.856);
            left: 50%;
            transform: translateX(-50%);
        }
        .button-wrapper button:hover {
            background-color: rgba(0, 156, 34, 0.877);
        }
        .question-label
        {
            position: relative;
            width:100%;
            text-align: left;
            padding:10px;
            padding-top:30px;
            padding-left:0px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: clamp(2vh, 2.5vw, 1.5vh);
            font-weight: 400;
        }
        .question-input
        {
            position: relative;
            width:100%;
            text-align: left;
            padding:10px;
            resize:vertical;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: clamp(1.8vh, 2.3vw, 1.2vh);
            box-sizing: border-box;
            border-radius: 4px;
            min-height:100px;
            border: 1px solid #ccc;

        }
        /* Media queries for different screen sizes */
        @media (max-width: 768px) {
            .tag-line {
                font-size: clamp(2vh, 3vw, 2.4vh);
            }
            .hint-line {
                font-size: clamp(1.5vh, 2.5vw, 2vh);
            }
            .button-wrapper button {
                font-size: clamp(2vh, 3vw, 2.3vh);
            }
            .question-label {
                font-size: clamp(1.5vh, 2vw, 1vh);
            }
            .question-input {
                font-size: clamp(1.3vh, 1.8vw, 0.7vh);
            }
        }
    </style>
    <script>
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }

        function setCookie(name, value, days) {
            const d = new Date();
            d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
            const expires = `expires=${d.toUTCString()}`;
            document.cookie = `${name}=${value}; ${expires}; path=/`;
        }

        function getEmailFromURL() {
            const params = new URLSearchParams(window.location.search);
            return params.get('invitee_email');
        }

        // Function to submit form data
        function SubmitForm() {
            
            const message = document.querySelector('.hint-line');
            const btn = document.querySelector('#submitBtn');

            btn.innerHTML = "Submitting...";
            
            var email = getCookie("email");
            if(!email)
            {
                email = getEmailFromURL();
            }
            // Collect all contents from textareas
            var formData = {
                email: email,
                Q1: document.querySelector('.Q1').value,
                Q2: document.querySelector('.Q2').value,
                Q3: document.querySelector('.Q3').value,
                Q4: document.querySelector('.Q4').value,
                Q5: document.querySelector('.Q5').value,
                Q6: document.querySelector('.Q6').value,
                Q7: document.querySelector('.Q7').value
            };

            // Send data to Google Apps Script
            fetch('https://script.google.com/macros/s/AKfycbxgudzhKEf8bNmRhan-H1ZAkr7arxKn1fgEoo4_NGnDoTbTGAxyEKueV1OCIPc6Uu3H1g/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ formdata: formData })
            })
            .then(response => {
                if (response.ok) {
                    // If data is successfully submitted, redirect
                    window.location.href = 'https://info.msocialverse.com/ThankYou.html';
                } else {
                    // Handle errors
                    console.error('Failed to submit form data');
                    btn.innerHTML = "Submit";
                    message.innerHTML = "Form Failed to Submit";
                    message.style.display = 'block';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                btn.innerHTML = "Submit";
                message.innerHTML = "Form Failed to Submit";
                message.style.display = 'block';
            });
        }

        // Function to make textarea values persistent
        function PersistTextareaValues() {
            // Loop through textareas
            var textareas = document.querySelectorAll('textarea');
            textareas.forEach(function(textarea) {
                // Check if localStorage has a value for this textarea
                if (localStorage.getItem(textarea.className)) {
                    // If yes, set the value
                    textarea.value = localStorage.getItem(textarea.className);
                }

                // Listen for changes in the textarea
                textarea.addEventListener('input', function() {
                    // Store the value in localStorage
                    localStorage.setItem(textarea.className, textarea.value);
                });
            });
        }

        // Call PersistTextareaValues when the page loads
        window.onload = function() {
            PersistTextareaValues();
        };


    </script>
</head>
<body>
    <div class="container">
        <div class="logo section">
            <img src="images/logo.png">
        </div>
        
        <div class="tag-line section">Help us Understand your requirement better before the call</div>
        <div class="questions section">
            <div class="section">
                <div class="question-label"><b>Booking Reason:</b> What prompted you to book this meeting with mSocial? (Briefly explain)</div>
                <textarea class="question-input Q1" placeholder="Type you answer here."></textarea>
            </div>
            <div class="section">
                <div class="question-label"><b>Decision Makers:</b> Will anyone else join the call? (List any key decision-makers)</div>
                <textarea class="question-input Q2" placeholder="Type you answer here."></textarea>
            </div>
            <div class="section">
                <div class="question-label"><b>Current Goals:</b> What is your main business goal right now? (Be specific and quantifiable)</div>
                <textarea class="question-input Q3" placeholder="Type you answer here."></textarea>
            </div>
            <div class="section">
                <div class="question-label"><b>Bigger Goal:</b> Why is this goal important to you? (Explain the bigger objective)</div>
                <textarea class="question-input Q4" placeholder="Type you answer here."></textarea>
            </div>
            <div class="section">
                <div class="question-label"><b>Current Situation:</b> Where do you currently stand in achieving this goal? (Describe your current efforts)</div>
                <textarea class="question-input Q5" placeholder="Type you answer here."></textarea>
            </div>
            <div class="section">
                <div class="question-label"><b>Challenges:</b> What challenges are you facing in achieving this goal? (List specific challenges)</div>
                <textarea class="question-input Q6" placeholder="Type you answer here."></textarea>
            </div>
            <div class="section">
                <div class="question-label"><b>Goal with mSocial Call:</b> What do you hope to gain from the call with mSocial? (Describe your main goal)</div>
                <textarea class="question-input Q7" placeholder="Type you answer here."></textarea>
            </div>
            
        </div>
        <div class="button-wrapper section">
            <button id="submitBtn" onclick="SubmitForm()">Submit</button>
        </div>
        <div class="hint-line section">Form Failed to submit</div>
        
        
    </div>
</body>
</html>
